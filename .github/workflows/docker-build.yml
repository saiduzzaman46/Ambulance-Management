name: Docker Build and Deploy

on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  build:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v3

    - name: Set up Docker Buildx
      uses: docker/setup-buildx-action@v2

    - name: Build Backend Image
      working-directory: ./AmbulanceManagement_Backend
      run: docker build -t ambulance-backend .

    - name: Build Frontend Image
      working-directory: ./ambulancemanagement_frontend
      run: docker build -t ambulance-frontend .

  # Uncomment this section when ready to deploy
  # deploy:
  #   needs: build
  #   runs-on: ubuntu-latest
  #   if: github.ref == 'refs/heads/main'
  #   
  #   steps:
  #   - name: Checkout code
  #     uses: actions/checkout@v3
  #   
  #   - name: Deploy with Docker Compose
  #     env:
  #       DB_USER: ${{ secrets.DB_USER }}
  #       DB_PASSWORD: ${{ secrets.DB_PASSWORD }}
  #       DB_CONNECTION_STRING: ${{ secrets.DB_CONNECTION_STRING }}
  #       NEXT_PUBLIC_API_URL: ${{ secrets.NEXT_PUBLIC_API_URL }}
  #     run: |
  #       echo "Deploying with secrets from GitHub..."
  #       # Add your deployment commands here
  #       # docker-compose up -d
